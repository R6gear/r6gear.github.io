
<template id="query-ignore-embed">
    <div>
        <a><i v-if="user" aria-hidden="true" id="ignorePlugin" class="fa" :class="iconClass" :title="iconTitle" @click="onIgnore"></i></a>
    </div>
</template>
     
    <script>
    kiwi.plugin('user-more', function(kiwi, log) {
     
        var queryIgnoreEmbedded = new kiwi.Vue({
            template: '#query-ignore-embed',
            data: {
                accept_text: 'Ignora',
            },
            computed: {
                user: function() {
                    var network = kiwi.state.getActiveNetwork();
                    var buffer = kiwi.state.getActiveBuffer();
                    if (!network || !buffer) return;
                    return network.userByName(buffer.name);
                },
                iconTitle() {
                    return this.user.ignore ? 'Scoate ignore' : 'Ignora';
                },
                iconClass() {
                    return this.user.ignore ? 'fa-ban red-ban' : 'fa-ban';
                },
            },
            methods: {
                onIgnore(event) {
                    this.user.ignore = !this.user.ignore;

                    var action;
     
                    if (this.user.ignore) {
                        action = 'L-ai ignorat pe';
                        type = 'error'
                    } else {
                        action = 'Ai scos ignore lui';
                        type= 'error'
                    }

                    var mynick = kiwi.state.getActiveNetwork().nick;
                    var buffer = kiwi.state.getActiveBuffer();
                    kiwi.state.addMessage(buffer,
                        {
                            'message': 'âš   ' + action + ' ' + buffer.name + '.',
                            'bodyTemplate': '',
                            'nick': '',
                            'ident': 'INFO',
                            'hostname': 'INFO',
                            'target': mynick,
                        }
                    );

                }
            }
        });
     
        queryIgnoreEmbedded.$mount();
        kiwi.addUi('header_query', queryIgnoreEmbedded.$el);
    });
    </script>
     
    <style>
    #ignorePlugin {

    }
    
    .red-ban {
        color: red;
    }
    </style>
